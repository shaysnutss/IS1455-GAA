---
title: "Hands-On exercise 3 : 1st Order Spatial Point Patterns Analysis Methods"

execute: 
  warning: false
date: "`r Sys.Date()`"
---

## Overview

here we are doing spatial point analysis where we are basically studying and analysing the spread of points in a space.

It helps us answer tje following questions:

1.  are the childcare centres in Singapore randomly distributed throughout the country?
2.  if the answer is not, then the next logical question is where are the locations with higher concentration of childcare centres?

## 

## Data

1.  childcare
2.  MP14_SUBZONE_WEB_PL
3.  CostalOutline

## Installing and loading the R packages

We need to install and load the R packages into the R environment to use them

```{r}
pacman::p_load(maptools, sf, raster, spatstat, tmap)
```

If you aren't able to install maptools, do this:

```{r}
install.packages("maptools", repos="http://R-Forge.R-project.org")


```


## Spatial Data Wrangling

### Importing the spatial data

We will use the st_read() function of sf package to import geospatial datasets into R.

Let's import the first one of ChildCareServices:

```{r}
childcare_sf <- st_read("data/ChildCareServices.geojson")
```

We can see that the CRS is not what we want let's transform it to SVY21

```{r}
childcare_sf <- st_transform(childcare_sf, crs = 3414)
```

Let's print out childcare_sf to see what is the CRS.

```{r}
st_geometry(childcare_sf)
```

Let's import coastal outline.

```{r}
sg_sf <- st_read(dsn = "data/geospatial", layer="CostalOutline")

```

When we look at the coordinate reference system of coastal outline, we see that the user input is SVY21 but the correct EPSG code is 9001 instead of 3414.

```{r}
st_crs(sg_sf)
```

So here we change it to 3414.

Reminder we don't use st_transform() because the CRS is already SVY21, it's just the ESPG code that is wrong!

```{r}

sg_sf <- st_set_crs(sg_sf, 3414)
```


Now let's recheck if the coordiante system and ESPG code match.

```{r}
st_crs(sg_sf)
```

Now let's import MP_14_SUBZONE_WEB_PL.

```{r}
mpsz_sf <- st_read(dsn = "data/geospatial", 
                layer = "MP14_SUBZONE_WEB_PL")
```

Let's check the coordinate system, it has to be SVY21 so that it is projected coordinate system, and the ESPG code has to match the SVY21.

```{r}
st_crs(mpsz_sf)
```

Since it's 9001 and not 3414, let's change the code.

```{r}
mpsz_sf <- st_set_crs(mpsz_sf, 3414)
```

Let's check.

```{r}
st_crs(mpsz_sf)
```

### Mapping the Geospatial data sets
```{r}
col_names <- names(childcare_sf)
print(col_names)
```

```{r}
tmap_mode("plot")
tm_shape(mpsz_sf) +
  tm_polygons() +
  tm_shape(childcare_sf) +  
  tm_dots()
```





